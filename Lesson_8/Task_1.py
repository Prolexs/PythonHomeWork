справочник = []

def сохранить_справочник():
    with open('справочник.txt', 'w') as файл:
        for контакт in справочник:
            файл.write(f"{контакт['фамилия']},{контакт['имя']},{контакт['номер']}\n")
    print("Справочник сохранен в файле 'справочник.txt'.")

def загрузить_справочник():
    try:
        with open('справочник.txt', 'r') as файл:
            for строка in файл:
                данные = строка.strip().split(',')
                if len(данные) == 3:
                    контакт = {
                        'фамилия': данные[0],
                        'имя': данные[1],
                        'номер': данные[2]
                    }
                    справочник.append(контакт)
        print("Справочник успешно загружен.")
    except FileNotFoundError:
        print("Файл 'справочник.txt' не найден. Создан новый пустой справочник.")

def добавить_контакт():
    фамилия = input("Введите фамилию: ")
    имя = input("Введите имя: ")
    номер = input("Введите номер телефона: ")
    контакт = {
        'фамилия': фамилия,
        'имя': имя,
        'номер': номер
    }
    справочник.append(контакт)
    print("Контакт успешно добавлен!")
    сохранить_справочник()

def изменить_контакт():
    фамилия = input("Введите фамилию контакта для изменения: ")
    имя = input("Введите имя контакта для изменения: ")
    новый_номер = input("Введите новый номер телефона: ")
    for контакт in справочник:
        if контакт['фамилия'].lower() == фамилия.lower() and контакт['имя'].lower() == имя.lower():
            контакт['номер'] = новый_номер
            print("Контакт успешно изменен!")
            сохранить_справочник()
            return
    print("Контакт не найден.")

def удалить_контакт():
    фамилия = input("Введите фамилию контакта для удаления: ")
    имя = input("Введите имя контакта для удаления: ")
    for контакт in справочник:
        if контакт['фамилия'].lower() == фамилия.lower() and контакт['имя'].lower() == имя.lower():
            справочник.remove(контакт)
            print("Контакт успешно удален!")
            сохранить_справочник()
            return
    print("Контакт не найден.")

def найти_контакт():
    запрос = input("Введите фамилию, имя или номер телефона для поиска: ").lower()
    найденные_контакты = []
    for контакт in справочник:
        if запрос in контакт['фамилия'].lower() or запрос in контакт['имя'].lower() or запрос in контакт['номер']:
            найденные_контакты.append(контакт)
    if найденные_контакты:
        print("Найденные контакты:")
        for контакт in найденные_контакты:
            print(контакт)
    else:
        print("Контакты не найдены.")

def показать_все_контакты():
    if справочник:
        print("Все контакты:")
        for контакт in справочник:
            print(контакт)
    else:
        print("Справочник пуст.")

# Загрузка справочника из файла при запуске программы
загрузить_справочник()

while True:
    print("\nМеню:")
    print("1. Добавить контакт")
    print("2. Изменить контакт")
    print("3. Удалить контакт")
    print("4. Найти контакт")
    print("5. Показать все контакты")
    print("6. Выйти")

    выбор = input("Выберите действие (введите номер): ")

    if выбор == '1':
        добавить_контакт()
    elif выбор == '2':
        изменить_контакт()
    elif выбор == '3':
        удалить_контакт()
    elif выбор == '4':
        найти_контакт()
    elif выбор == '5':
        показать_все_контакты()
    elif выбор == '6':
        break
    else:
        print("Некорректный выбор. Попробуйте еще раз.")

